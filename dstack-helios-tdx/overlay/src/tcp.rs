// NB: the full implementation implements also other transports.